<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>计算机系统基础-Bomb Lab 实验报告 | 火</title><meta name="author" content="火"><meta name="copyright" content="火"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="中国海洋大学 计算机科学与技术系实验报告 姓名：火 年级：2022 专业： 科目：计算机系统原理 题目：Bomb Lab 实验时间：2023&#x2F;12&#x2F;15 实验成绩： 实验教师：  一、实验目的： 学习并熟练使用gdb调试器和objdump 理解汇编语言代码的行为或作用 提高阅读和理解汇编代码的能力  二、实验要求：实验共包括七个阶段，每个阶段考察机器级语言程序的不同方面，难度递增   阶段一：字符">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机系统基础-Bomb Lab 实验报告">
<meta property="og:url" content="https://yogurt114514.github.io/posts/bomblab.html">
<meta property="og:site_name" content="火">
<meta property="og:description" content="中国海洋大学 计算机科学与技术系实验报告 姓名：火 年级：2022 专业： 科目：计算机系统原理 题目：Bomb Lab 实验时间：2023&#x2F;12&#x2F;15 实验成绩： 实验教师：  一、实验目的： 学习并熟练使用gdb调试器和objdump 理解汇编语言代码的行为或作用 提高阅读和理解汇编代码的能力  二、实验要求：实验共包括七个阶段，每个阶段考察机器级语言程序的不同方面，难度递增   阶段一：字符">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://yogurt114514.github.io/img/avatar.png">
<meta property="article:published_time" content="2023-12-22T13:09:10.000Z">
<meta property="article:modified_time" content="2024-10-24T13:56:39.138Z">
<meta property="article:author" content="火">
<meta property="article:tag" content="作业">
<meta property="article:tag" content="实验报告">
<meta property="article:tag" content="计算机系统基础">
<meta property="article:tag" content="计基">
<meta property="article:tag" content="拆弹">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yogurt114514.github.io/img/avatar.png"><link rel="shortcut icon" href="/img/favicon.jpg"><link rel="canonical" href="https://yogurt114514.github.io/posts/bomblab.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        if (name && globalFn[key][name]) return
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const hour = new Date().getHours()
          const isNight = hour <= 6 || hour >= 18
          if (theme === undefined) isNight ? activateDarkMode() : activateLightMode()
          else theme === 'light' ? activateLightMode() : activateDarkMode()
        
      
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7f4579782fc8b43fcdf7b4e95427fa5d";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":-1,"unescape":true,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400,"highlightFullpage":true,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '计算机系统基础-Bomb Lab 实验报告',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-10-24 21:56:39'
}</script><link rel="stylesheet" href="/css/font.css"><link rel="preload" as="style" type="text/css" href="/css/font.css"><link rel="stylesheet" href="dist/css/share.min.css"><link rel="stylesheet" href="/css/topcard.css"><link rel="stylesheet" href="/css/mouse.css"><link rel="stylesheet" href="/css/music.css"><link rel="stylesheet" href="/css/flink.css"><link rel="stylesheet" href="/css/icat.css"><link rel="stylesheet" href="/css/anzhiyu-color.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">53</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-regular fa-folder"></i><span> 归档</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa-solid fa-folder-tree"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/charts/"><i class="fa-fw fa-solid fa-chart-area"></i><span> 统计</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-heart"></i><span> 最爱</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/f-person/"><i class="fa-fw fa-solid fa-person"></i><span> 人</span></a></li><li><a class="site-page child" href="/f-music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/f-novel/"><i class="fa-fw fa-solid fa-book"></i><span> 小说</span></a></li><li><a class="site-page child" href="/f-qqgroup/"><i class="fa-fw fa-brands fa-qq"></i><span> Q群</span></a></li><li><a class="site-page child" href="/f-speciality/"><i class="fa-fw fa-brands fa-gratipay"></i><span> 特长</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-star"></i><span> 收藏</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/bookmark/"><i class="fa-fw fa-solid fa-bars"></i><span> 网址</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-circle-user"></i><span> 个人</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/self/"><i class="fa-fw fa-solid fa-user"></i><span> 自我</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fa-solid fa-address-card"></i><span> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img fixed" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">火</span></a><a class="nav-page-title" href="/"><span class="site-name">计算机系统基础-Bomb Lab 实验报告</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-regular fa-folder"></i><span> 归档</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fa-solid fa-folder-tree"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/charts/"><i class="fa-fw fa-solid fa-chart-area"></i><span> 统计</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-heart"></i><span> 最爱</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/f-person/"><i class="fa-fw fa-solid fa-person"></i><span> 人</span></a></li><li><a class="site-page child" href="/f-music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/f-novel/"><i class="fa-fw fa-solid fa-book"></i><span> 小说</span></a></li><li><a class="site-page child" href="/f-qqgroup/"><i class="fa-fw fa-brands fa-qq"></i><span> Q群</span></a></li><li><a class="site-page child" href="/f-speciality/"><i class="fa-fw fa-brands fa-gratipay"></i><span> 特长</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-star"></i><span> 收藏</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/bookmark/"><i class="fa-fw fa-solid fa-bars"></i><span> 网址</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-circle-user"></i><span> 个人</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/self/"><i class="fa-fw fa-solid fa-user"></i><span> 自我</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fa-solid fa-address-card"></i><span> 关于</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div><div id="daylight-button"><span class="site-page social-icon daynight"><i class="fas fa-adjust fa-fw"></i><span> 昼/夜</span></span></div><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">计算机系统基础-Bomb Lab 实验报告</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-12-22T13:09:10.000Z" title="发表于 2023-12-22 21:09:10">2023-12-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-24T13:56:39.138Z" title="更新于 2024-10-24 21:56:39">2024-10-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/">实验报告</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">7.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>40分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><h1 id="中国海洋大学-计算机科学与技术系"><a href="#中国海洋大学-计算机科学与技术系" class="headerlink" title="中国海洋大学 计算机科学与技术系"></a><strong><center>中国海洋大学 计算机科学与技术系</center></strong></h1><h2 id="实验报告"><a href="#实验报告" class="headerlink" title="实验报告"></a><u><center>实验报告</center></u></h2><blockquote>
<p><strong>姓名</strong>：火</p>
<p><strong>年级</strong>：2022</p>
<p><strong>专业</strong>：</p>
<p><strong>科目</strong>：计算机系统原理</p>
<p><strong>题目</strong>：Bomb Lab</p>
<p><strong>实验时间</strong>：2023/12/15</p>
<p><strong>实验成绩</strong>：</p>
<p><strong>实验教师</strong>：</p>
</blockquote>
<h2 id="一、实验目的："><a href="#一、实验目的：" class="headerlink" title="一、实验目的："></a>一、实验目的：</h2><ol>
<li>学习并熟练使用<code>gdb</code>调试器和<code>objdump</code></li>
<li>理解汇编语言代码的行为或作用</li>
<li>提高阅读和理解汇编代码的能力</li>
</ol>
<h2 id="二、实验要求："><a href="#二、实验要求：" class="headerlink" title="二、实验要求："></a>二、实验要求：</h2><p>实验共包括七个阶段，每个阶段考察机器级语言程序的不同方面，难度递增</p>
<blockquote>
<ul>
<li><strong>阶段一</strong>：字符串比较</li>
<li><strong>阶段二</strong>：循环</li>
<li><strong>阶段三</strong>：条件/分支，含switch语句</li>
<li><strong>阶段四</strong>：递归调用和栈</li>
<li><strong>阶段五</strong>：指针</li>
<li><strong>阶段六</strong>：链表/指针/结构</li>
<li><strong>隐藏阶段</strong>：阶段四之后附加特定字符串后出现</li>
</ul>
</blockquote>
<h2 id="三、实验内容："><a href="#三、实验内容：" class="headerlink" title="三、实验内容："></a>三、实验内容：</h2><h3 id="·-拆弹前准备"><a href="#·-拆弹前准备" class="headerlink" title="· 拆弹前准备"></a><code>· 拆弹前准备</code></h3><p>打开解压好的<code>bomb18</code>文件夹，其中有我们本次实验的目标文件<code>bomb</code>和<code>bomb.c</code>源文件</p>
<p><img src="/img/jj/bomblab/1.png" alt="img"></p>
<p>用<code>Visual Studio Code</code>打开之后发现</p>
<p><img src="/img/jj/bomblab/2.png" alt="img"></p>
<p>主函数<code>main</code>下有六个主要部分构成，分别对应着六个阶段（phase），</p>
<p>每个部分都由</p>
<p>输入函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">input = read_line();</span><br></pre></td></tr></table></figure>
<p>炸弹函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phase_x(input);</span><br></pre></td></tr></table></figure>
<p>拆除成功函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phase_defused();</span><br></pre></td></tr></table></figure>
<p>提示语</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;xxxxxxxxxx&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>显然我们应该关注的是炸弹函数<code>phase_x（x=1,2,…,6）</code></p>
<p>但是我们注意到最后的注释部分：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Wow, they got it!  But isn&#x27;t something... missing?  Perhaps</span></span><br><span class="line"><span class="comment"> * something they overlooked?  Mua ha ha ha ha! */</span></span><br></pre></td></tr></table></figure>
<p>指的应该就是隐藏关卡</p>
<p><img src="/img/jj/bomblab/3.png" alt="img"></p>
<p>最后了解完结构就可以开始拆弹了~</p>
<h3 id="·-启动GDB"><a href="#·-启动GDB" class="headerlink" title="· 启动GDB"></a><code>· 启动GDB</code></h3><p>打开终端，<code>cd</code>至<code>bomb</code>目录下，并输入下面命令启动GDB</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gdb bomb</span><br></pre></td></tr></table></figure>
<p><img src="/img/jj/bomblab/4.png" alt="img"></p>
<h3 id="·-phase-1"><a href="#·-phase-1" class="headerlink" title="· phase_1"></a><code>· phase_1</code></h3><p>先进行反汇编</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disassemble phase_1</span><br></pre></td></tr></table></figure>
<p><img src="/img/jj/bomblab/5.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function phase_1</span><br><span class="line">   0x00000000000015b4 &lt;+0&gt;:	endbr64 </span><br><span class="line">   0x00000000000015b8 &lt;+4&gt;:	push   rbp</span><br><span class="line">   0x00000000000015b9 &lt;+5&gt;:	mov    rbp,rsp</span><br><span class="line">   0x00000000000015bc &lt;+8&gt;:	lea    rsi,[rip+0x1b8d]        # 0x3150</span><br><span class="line">   0x00000000000015c3 &lt;+15&gt;:	call   0x1b86 &lt;strings_not_equal&gt;</span><br><span class="line">   0x00000000000015c8 &lt;+20&gt;:	test   eax,eax</span><br><span class="line">   0x00000000000015ca &lt;+22&gt;:	jne    0x15ce &lt;phase_1+26&gt;</span><br><span class="line">   0x00000000000015cc &lt;+24&gt;:	pop    rbp</span><br><span class="line">   0x00000000000015cd &lt;+25&gt;:	ret    </span><br><span class="line">   0x00000000000015ce &lt;+26&gt;:	call   0x1e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x00000000000015d3 &lt;+31&gt;:	jmp    0x15cc &lt;phase_1+24&gt;</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<p>显然里面调用了一个<code>strings_not_equal</code>函数，我们把它也反汇编出来</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disassemble strings_not_equal</span><br></pre></td></tr></table></figure>
<p><img src="/img/jj/bomblab/6.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function strings_not_equal:</span><br><span class="line">   0x0000000000001b86 &lt;+0&gt;:	endbr64 </span><br><span class="line">   0x0000000000001b8a &lt;+4&gt;:	push   rbp</span><br><span class="line">   0x0000000000001b8b &lt;+5&gt;:	mov    rbp,rsp</span><br><span class="line">   0x0000000000001b8e &lt;+8&gt;:	push   r13</span><br><span class="line">   0x0000000000001b90 &lt;+10&gt;:	push   r12</span><br><span class="line">   0x0000000000001b92 &lt;+12&gt;:	push   rbx</span><br><span class="line">   0x0000000000001b93 &lt;+13&gt;:	sub    rsp,0x8</span><br><span class="line">   0x0000000000001b97 &lt;+17&gt;:	mov    rbx,rdi</span><br><span class="line">   0x0000000000001b9a &lt;+20&gt;:	mov    r12,rsi</span><br><span class="line">   0x0000000000001b9d &lt;+23&gt;:	call   0x1b65 &lt;string_length&gt;</span><br><span class="line">   0x0000000000001ba2 &lt;+28&gt;:	mov    r13d,eax</span><br><span class="line">   0x0000000000001ba5 &lt;+31&gt;:	mov    rdi,r12</span><br><span class="line">   0x0000000000001ba8 &lt;+34&gt;:	call   0x1b65 &lt;string_length&gt;</span><br><span class="line">   0x0000000000001bad &lt;+39&gt;:	mov    edx,eax</span><br><span class="line">   0x0000000000001baf &lt;+41&gt;:	mov    eax,0x1</span><br><span class="line">   0x0000000000001bb4 &lt;+46&gt;:	cmp    r13d,edx</span><br><span class="line">   0x0000000000001bb7 &lt;+49&gt;:	jne    0x1bea &lt;strings_not_equal+100&gt;</span><br><span class="line">   0x0000000000001bb9 &lt;+51&gt;:	movzx  edx,BYTE PTR [rbx]</span><br><span class="line">   0x0000000000001bbc &lt;+54&gt;:	test   dl,dl</span><br><span class="line">   0x0000000000001bbe &lt;+56&gt;:	je     0x1bde &lt;strings_not_equal+88&gt;</span><br><span class="line">   0x0000000000001bc0 &lt;+58&gt;:	mov    eax,0x0</span><br><span class="line">   0x0000000000001bc5 &lt;+63&gt;:	cmp    BYTE PTR [r12+rax*1],dl</span><br><span class="line">   0x0000000000001bc9 &lt;+67&gt;:	jne    0x1be5 &lt;strings_not_equal+95&gt;</span><br><span class="line">   0x0000000000001bcb &lt;+69&gt;:	add    rax,0x1</span><br><span class="line">   0x0000000000001bcf &lt;+73&gt;:	movzx  edx,BYTE PTR [rbx+rax*1]</span><br><span class="line">   0x0000000000001bd3 &lt;+77&gt;:	test   dl,dl</span><br><span class="line">   0x0000000000001bd5 &lt;+79&gt;:	jne    0x1bc5 &lt;strings_not_equal+63&gt;</span><br><span class="line">   0x0000000000001bd7 &lt;+81&gt;:	mov    eax,0x0</span><br><span class="line">   0x0000000000001bdc &lt;+86&gt;:	jmp    0x1bea &lt;strings_not_equal+100&gt;</span><br><span class="line">   0x0000000000001bde &lt;+88&gt;:	mov    eax,0x0</span><br><span class="line">   0x0000000000001be3 &lt;+93&gt;:	jmp    0x1bea &lt;strings_not_equal+100&gt;</span><br><span class="line">   0x0000000000001be5 &lt;+95&gt;:	mov    eax,0x1</span><br><span class="line">   0x0000000000001bea &lt;+100&gt;:	add    rsp,0x8</span><br><span class="line">   0x0000000000001bee &lt;+104&gt;:	pop    rbx</span><br><span class="line">   0x0000000000001bef &lt;+105&gt;:	pop    r12</span><br><span class="line">   0x0000000000001bf1 &lt;+107&gt;:	pop    r13</span><br><span class="line">   0x0000000000001bf3 &lt;+109&gt;:	pop    rbp</span><br><span class="line">   0x0000000000001bf4 &lt;+110&gt;:	ret    </span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<p>同理，<code>string_length</code>函数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disassemble string_length</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function string_length:</span><br><span class="line">   0x0000000000001b65 &lt;+0&gt;:	endbr64 </span><br><span class="line">   0x0000000000001b69 &lt;+4&gt;:	cmp    BYTE PTR [rdi],0x0</span><br><span class="line">   0x0000000000001b6c &lt;+7&gt;:	je     0x1b80 &lt;string_length+27&gt;</span><br><span class="line">   0x0000000000001b6e &lt;+9&gt;:	mov    eax,0x0</span><br><span class="line">   0x0000000000001b73 &lt;+14&gt;:	add    rdi,0x1</span><br><span class="line">   0x0000000000001b77 &lt;+18&gt;:	add    eax,0x1</span><br><span class="line">   0x0000000000001b7a &lt;+21&gt;:	cmp    BYTE PTR [rdi],0x0</span><br><span class="line">   0x0000000000001b7d &lt;+24&gt;:	jne    0x1b73 &lt;string_length+14&gt;</span><br><span class="line">   0x0000000000001b7f &lt;+26&gt;:	ret    </span><br><span class="line">   0x0000000000001b80 &lt;+27&gt;:	mov    eax,0x0</span><br><span class="line">   0x0000000000001b85 &lt;+32&gt;:	ret    </span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<p>至此，光是通过函数名推理我们也能得知需要输入一个字符串</p>
<p>分析一下发现，输入的字符串由<code>strings_not_equal</code>函数进入<code>string_length</code>函数，先判断字符串长度是否相等，相等则<code>eax</code>存0返回，不相等则<code>eax</code>存1返回</p>
<p>同时观察到<code>phase_1</code>中描述</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0x00000000000015c8 &lt;+20&gt;:	test   eax,eax</span><br><span class="line">0x00000000000015ca &lt;+22&gt;:	jne    0x15ce &lt;phase_1+26&gt;</span><br><span class="line">0x00000000000015cc &lt;+24&gt;:	pop    rbp</span><br><span class="line">0x00000000000015cd &lt;+25&gt;:	ret    </span><br><span class="line">0x00000000000015ce &lt;+26&gt;:	call   0x1e02 &lt;explode_bomb&gt;</span><br></pre></td></tr></table></figure>
<p>当<code>eax</code>!= 0 时跳转到引爆函数，显然只有<code>eax</code>== 0 且字符串相等时才能成功拆除</p>
<p>所以应该找到这个要比较的字符串，我们注意到<code>phase_1</code>中有个地址<code>0x3150</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x00000000000015bc &lt;+8&gt;:	lea    rsi,[rip+0x1b8d]        # 0x3150</span><br></pre></td></tr></table></figure>
<p>查看这个内存地址中的值</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x/s 0x3150</span><br></pre></td></tr></table></figure>
<p><img src="/img/jj/bomblab/7.png" alt="img"></p>
<p>显然这个字符串就是第一关的答案</p>
<blockquote>
<p><code>When a problem comes along, you must zip it!</code></p>
</blockquote>
<h3 id="·-phase-2"><a href="#·-phase-2" class="headerlink" title="· phase_2"></a><code>· phase_2</code></h3><p>先为<code>phase_2</code>设置断点</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) b phase_2</span><br></pre></td></tr></table></figure>
<p>将第一关的答案先存在<code>ans.txt</code>中，用<code>r</code>命令运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) r ans.txt</span><br></pre></td></tr></table></figure>
<p>随便输入一个字符串后反汇编<code>phase_2</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disassemble phase_2</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function phase_2:</span><br><span class="line">=&gt; 0x00005555555555d5 &lt;+0&gt;:	endbr64 </span><br><span class="line">   0x00005555555555d9 &lt;+4&gt;:	push   rbp</span><br><span class="line">   0x00005555555555da &lt;+5&gt;:	mov    rbp,rsp</span><br><span class="line">   0x00005555555555dd &lt;+8&gt;:	push   r12</span><br><span class="line">   0x00005555555555df &lt;+10&gt;:	push   rbx</span><br><span class="line">   0x00005555555555e0 &lt;+11&gt;:	sub    rsp,0x20</span><br><span class="line">   0x00005555555555e4 &lt;+15&gt;:	mov    rax,QWORD PTR fs:0x28</span><br><span class="line">   0x00005555555555ed &lt;+24&gt;:	mov    QWORD PTR [rbp-0x18],rax</span><br><span class="line">   0x00005555555555f1 &lt;+28&gt;:	xor    eax,eax</span><br><span class="line">   0x00005555555555f3 &lt;+30&gt;:	lea    rsi,[rbp-0x30]</span><br><span class="line">   0x00005555555555f7 &lt;+34&gt;:	call   0x555555555e42 &lt;read_six_numbers&gt;</span><br><span class="line">   0x00005555555555fc &lt;+39&gt;:	cmp    DWORD PTR [rbp-0x30],0x0</span><br><span class="line">   0x0000555555555600 &lt;+43&gt;:	js     0x55555555560d &lt;phase_2+56&gt;</span><br><span class="line">   0x0000555555555602 &lt;+45&gt;:	lea    r12,[rbp-0x30]</span><br><span class="line">   0x0000555555555606 &lt;+49&gt;:	mov    ebx,0x1</span><br><span class="line">   0x000055555555560b &lt;+54&gt;:	jmp    0x555555555625 &lt;phase_2+80&gt;</span><br><span class="line">   0x000055555555560d &lt;+56&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x0000555555555612 &lt;+61&gt;:	jmp    0x555555555602 &lt;phase_2+45&gt;</span><br><span class="line">   0x0000555555555614 &lt;+63&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x0000555555555619 &lt;+68&gt;:	add    ebx,0x1</span><br><span class="line">   0x000055555555561c &lt;+71&gt;:	add    r12,0x4</span><br><span class="line">   0x0000555555555620 &lt;+75&gt;:	cmp    ebx,0x6</span><br><span class="line">   0x0000555555555623 &lt;+78&gt;:	je     0x555555555634 &lt;phase_2+95&gt;</span><br><span class="line">   0x0000555555555625 &lt;+80&gt;:	mov    eax,ebx</span><br><span class="line">   0x0000555555555627 &lt;+82&gt;:	add    eax,DWORD PTR [r12]</span><br><span class="line">   0x000055555555562b &lt;+86&gt;:	cmp    DWORD PTR [r12+0x4],eax</span><br><span class="line">   0x0000555555555630 &lt;+91&gt;:	je     0x555555555619 &lt;phase_2+68&gt;</span><br><span class="line">   0x0000555555555632 &lt;+93&gt;:	jmp    0x555555555614 &lt;phase_2+63&gt;</span><br><span class="line">   0x0000555555555634 &lt;+95&gt;:	mov    rax,QWORD PTR [rbp-0x18]</span><br><span class="line">   0x0000555555555638 &lt;+99&gt;:	xor    rax,QWORD PTR fs:0x28</span><br><span class="line">   0x0000555555555641 &lt;+108&gt;:	jne    0x55555555564c &lt;phase_2+119&gt;</span><br><span class="line">   0x0000555555555643 &lt;+110&gt;:	add    rsp,0x20</span><br><span class="line">   0x0000555555555647 &lt;+114&gt;:	pop    rbx</span><br><span class="line">   0x0000555555555648 &lt;+115&gt;:	pop    r12</span><br><span class="line">   0x000055555555564a &lt;+117&gt;:	pop    rbp</span><br><span class="line">   0x000055555555564b &lt;+118&gt;:	ret    </span><br><span class="line">   0x000055555555564c &lt;+119&gt;:	call   0x555555555220 &lt;__stack_chk_fail@plt&gt;</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<p>同理，反汇编出<code>read_six_numbers</code>函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function read_six_numbers:</span><br><span class="line">   0x0000555555555e42 &lt;+0&gt;:	endbr64 </span><br><span class="line">   0x0000555555555e46 &lt;+4&gt;:	push   rbp</span><br><span class="line">   0x0000555555555e47 &lt;+5&gt;:	mov    rbp,rsp</span><br><span class="line">   0x0000555555555e4a &lt;+8&gt;:	mov    rdx,rsi</span><br><span class="line">   0x0000555555555e4d &lt;+11&gt;:	lea    rcx,[rsi+0x4]</span><br><span class="line">   0x0000555555555e51 &lt;+15&gt;:	lea    rax,[rsi+0x14]</span><br><span class="line">   0x0000555555555e55 &lt;+19&gt;:	push   rax</span><br><span class="line">   0x0000555555555e56 &lt;+20&gt;:	lea    rax,[rsi+0x10]</span><br><span class="line">   0x0000555555555e5a &lt;+24&gt;:	push   rax</span><br><span class="line">   0x0000555555555e5b &lt;+25&gt;:	lea    r9,[rsi+0xc]</span><br><span class="line">   0x0000555555555e5f &lt;+29&gt;:	lea    r8,[rsi+0x8]</span><br><span class="line">   0x0000555555555e63 &lt;+33&gt;:	lea    rsi,[rip+0x152f]        # 0x555555557399</span><br><span class="line">   0x0000555555555e6a &lt;+40&gt;:	mov    eax,0x0</span><br><span class="line">   0x0000555555555e6f &lt;+45&gt;:	call   0x5555555552c0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">   0x0000555555555e74 &lt;+50&gt;:	add    rsp,0x10</span><br><span class="line">   0x0000555555555e78 &lt;+54&gt;:	cmp    eax,0x5</span><br><span class="line">   0x0000555555555e7b &lt;+57&gt;:	jle    0x555555555e7f &lt;read_six_numbers+61&gt;</span><br><span class="line">   0x0000555555555e7d &lt;+59&gt;:	leave  </span><br><span class="line">   0x0000555555555e7e &lt;+60&gt;:	ret    </span><br><span class="line">   0x0000555555555e7f &lt;+61&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<p>显然要求我们输入6个数字，查看<code>read_six_numbers</code>中的某个内存地址的值，果然应证了我们的猜想</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x0000555555555e63 &lt;+33&gt;:	lea    rsi,[rip+0x152f]        # 0x555555557399</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x/s 0x555555557399</span><br></pre></td></tr></table></figure>
<p><img src="/img/jj/bomblab/8.png" alt="img"></p>
<p>阅读分析程序不难发现，输入的第一个数要求不能为负数，且后一个数与前一个数的差依次为<code>1</code>、<code>2</code>、<code>3</code>、<code>4</code>、<code>5</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0x00005555555555fc &lt;+39&gt;:	cmp    DWORD PTR [rbp-0x30],0x0</span><br><span class="line">0x0000555555555600 &lt;+43&gt;:	js     0x55555555560d &lt;phase_2+56&gt;</span><br><span class="line">0x000055555555560d &lt;+56&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0x0000555555555627 &lt;+82&gt;:	add    eax,DWORD PTR [r12]</span><br><span class="line">0x000055555555562b &lt;+86&gt;:	cmp    DWORD PTR [r12+0x4],eax</span><br><span class="line">0x0000555555555630 &lt;+91&gt;:	je     0x555555555619 &lt;phase_2+68&gt;</span><br></pre></td></tr></table></figure>
<p>显然有很多解，如：</p>
<blockquote>
<ol>
<li><code>0 1 3 6 10 15</code></li>
<li><code>1 2 4 7 11 16</code></li>
<li><code>2 3 5 8 12 17</code></li>
<li>…</li>
</ol>
</blockquote>
<h3 id="·-phase-3"><a href="#·-phase-3" class="headerlink" title="· phase_3"></a><code>· phase_3</code></h3><p>同理，反汇编<code>phase_3</code>函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function phase_3:</span><br><span class="line">=&gt; 0x0000555555555651 &lt;+0&gt;:	endbr64 </span><br><span class="line">   0x0000555555555655 &lt;+4&gt;:	push   rbp</span><br><span class="line">   0x0000555555555656 &lt;+5&gt;:	mov    rbp,rsp</span><br><span class="line">   0x0000555555555659 &lt;+8&gt;:	sub    rsp,0x20</span><br><span class="line">   0x000055555555565d &lt;+12&gt;:	mov    rax,QWORD PTR fs:0x28</span><br><span class="line">   0x0000555555555666 &lt;+21&gt;:	mov    QWORD PTR [rbp-0x8],rax</span><br><span class="line">   0x000055555555566a &lt;+25&gt;:	xor    eax,eax</span><br><span class="line">   0x000055555555566c &lt;+27&gt;:	lea    rcx,[rbp-0x11]</span><br><span class="line">   0x0000555555555670 &lt;+31&gt;:	lea    rdx,[rbp-0x10]</span><br><span class="line">   0x0000555555555674 &lt;+35&gt;:	lea    r8,[rbp-0xc]</span><br><span class="line">   0x0000555555555678 &lt;+39&gt;:	lea    rsi,[rip+0x1b27]        # 0x5555555571a6</span><br><span class="line">   0x000055555555567f &lt;+46&gt;:	call   0x5555555552c0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">   0x0000555555555684 &lt;+51&gt;:	cmp    eax,0x2</span><br><span class="line">   0x0000555555555687 &lt;+54&gt;:	jle    0x5555555556a7 &lt;phase_3+86&gt;</span><br><span class="line">   0x0000555555555689 &lt;+56&gt;:	cmp    DWORD PTR [rbp-0x10],0x7</span><br><span class="line">   0x000055555555568d &lt;+60&gt;:	ja     0x555555555790 &lt;phase_3+319&gt;</span><br><span class="line">   0x0000555555555693 &lt;+66&gt;:	mov    eax,DWORD PTR [rbp-0x10]</span><br><span class="line">   0x0000555555555696 &lt;+69&gt;:	lea    rdx,[rip+0x1b23]        # 0x5555555571c0</span><br><span class="line">   0x000055555555569d &lt;+76&gt;:	movsxd rax,DWORD PTR [rdx+rax*4]</span><br><span class="line">   0x00005555555556a1 &lt;+80&gt;:	add    rax,rdx</span><br><span class="line">   0x00005555555556a4 &lt;+83&gt;:	notrack jmp rax</span><br><span class="line">   0x00005555555556a7 &lt;+86&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x00005555555556ac &lt;+91&gt;:	jmp    0x555555555689 &lt;phase_3+56&gt;</span><br><span class="line">   0x00005555555556ae &lt;+93&gt;:	mov    eax,0x6a</span><br><span class="line">   0x00005555555556b3 &lt;+98&gt;:	cmp    DWORD PTR [rbp-0xc],0x104</span><br><span class="line">   0x00005555555556ba &lt;+105&gt;:	je     0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">   0x00005555555556c0 &lt;+111&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x00005555555556c5 &lt;+116&gt;:	mov    eax,0x6a</span><br><span class="line">   0x00005555555556ca &lt;+121&gt;:	jmp    0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">   0x00005555555556cf &lt;+126&gt;:	mov    eax,0x79</span><br><span class="line">   0x00005555555556d4 &lt;+131&gt;:	cmp    DWORD PTR [rbp-0xc],0x59</span><br><span class="line">   0x00005555555556d8 &lt;+135&gt;:	je     0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">   0x00005555555556de &lt;+141&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x00005555555556e3 &lt;+146&gt;:	mov    eax,0x79</span><br><span class="line">   0x00005555555556e8 &lt;+151&gt;:	jmp    0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">   0x00005555555556ed &lt;+156&gt;:	mov    eax,0x7a</span><br><span class="line">   0x00005555555556f2 &lt;+161&gt;:	cmp    DWORD PTR [rbp-0xc],0x9a</span><br><span class="line">   0x00005555555556f9 &lt;+168&gt;:	je     0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">   0x00005555555556ff &lt;+174&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x0000555555555704 &lt;+179&gt;:	mov    eax,0x7a</span><br><span class="line">   0x0000555555555709 &lt;+184&gt;:	jmp    0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">   0x000055555555570e &lt;+189&gt;:	mov    eax,0x69</span><br><span class="line">   0x0000555555555713 &lt;+194&gt;:	cmp    DWORD PTR [rbp-0xc],0x230</span><br><span class="line">   0x000055555555571a &lt;+201&gt;:	je     0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">   0x000055555555571c &lt;+203&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x0000555555555721 &lt;+208&gt;:	mov    eax,0x69</span><br><span class="line">   0x0000555555555726 &lt;+213&gt;:	jmp    0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">   0x0000555555555728 &lt;+215&gt;:	mov    eax,0x72</span><br><span class="line">   0x000055555555572d &lt;+220&gt;:	cmp    DWORD PTR [rbp-0xc],0x398</span><br><span class="line">   0x0000555555555734 &lt;+227&gt;:	je     0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">   0x0000555555555736 &lt;+229&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x000055555555573b &lt;+234&gt;:	mov    eax,0x72</span><br><span class="line">   0x0000555555555740 &lt;+239&gt;:	jmp    0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">   0x0000555555555742 &lt;+241&gt;:	mov    eax,0x71</span><br><span class="line">   0x0000555555555747 &lt;+246&gt;:	cmp    DWORD PTR [rbp-0xc],0xe2</span><br><span class="line">   0x000055555555574e &lt;+253&gt;:	je     0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">   0x0000555555555750 &lt;+255&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x0000555555555755 &lt;+260&gt;:	mov    eax,0x71</span><br><span class="line">   0x000055555555575a &lt;+265&gt;:	jmp    0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">   0x000055555555575c &lt;+267&gt;:	mov    eax,0x6f</span><br><span class="line">   0x0000555555555761 &lt;+272&gt;:	cmp    DWORD PTR [rbp-0xc],0x207</span><br><span class="line">   0x0000555555555768 &lt;+279&gt;:	je     0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">   0x000055555555576a &lt;+281&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x000055555555576f &lt;+286&gt;:	mov    eax,0x6f</span><br><span class="line">   0x0000555555555774 &lt;+291&gt;:	jmp    0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">   0x0000555555555776 &lt;+293&gt;:	mov    eax,0x77</span><br><span class="line">   0x000055555555577b &lt;+298&gt;:	cmp    DWORD PTR [rbp-0xc],0xe1</span><br><span class="line">   0x0000555555555782 &lt;+305&gt;:	je     0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">   0x0000555555555784 &lt;+307&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x0000555555555789 &lt;+312&gt;:	mov    eax,0x77</span><br><span class="line">   0x000055555555578e &lt;+317&gt;:	jmp    0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">   0x0000555555555790 &lt;+319&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x0000555555555795 &lt;+324&gt;:	mov    eax,0x6c</span><br><span class="line">   0x000055555555579a &lt;+329&gt;:	cmp    BYTE PTR [rbp-0x11],al</span><br><span class="line">   0x000055555555579d &lt;+332&gt;:	jne    0x5555555557b0 &lt;phase_3+351&gt;</span><br><span class="line">   0x000055555555579f &lt;+334&gt;:	mov    rax,QWORD PTR [rbp-0x8]</span><br><span class="line">   0x00005555555557a3 &lt;+338&gt;:	xor    rax,QWORD PTR fs:0x28</span><br><span class="line">   0x00005555555557ac &lt;+347&gt;:	jne    0x5555555557b7 &lt;phase_3+358&gt;</span><br><span class="line">   0x00005555555557ae &lt;+349&gt;:	leave  </span><br><span class="line">   0x00005555555557af &lt;+350&gt;:	ret    </span><br><span class="line">   0x00005555555557b0 &lt;+351&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x00005555555557b5 &lt;+356&gt;:	jmp    0x55555555579f &lt;phase_3+334&gt;</span><br><span class="line">   0x00005555555557b7 &lt;+358&gt;:	call   0x555555555220 &lt;__stack_chk_fail@plt&gt;</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<p>查看内存地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x0000555555555678 &lt;+39&gt;:	lea    rsi,[rip+0x1b27]        # 0x5555555571a6</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x/s 0x5555555571a6</span><br></pre></td></tr></table></figure>
<p><img src="/img/jj/bomblab/9.png" alt="img"></p>
<p>显然需要输入两个整数和一个字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0x000055555555566c &lt;+27&gt;:	lea    rcx,[rbp-0x11]</span><br><span class="line">0x0000555555555670 &lt;+31&gt;:	lea    rdx,[rbp-0x10]</span><br><span class="line">0x0000555555555674 &lt;+35&gt;:	lea    r8,[rbp-0xc]</span><br></pre></td></tr></table></figure>
<p>阅读程序知<code>%d</code> <code>%c</code> <code>%d</code>分别存到了<code>[rbp-0x10]</code> <code>[rbp-0x11]</code> <code>[rbp-0xc]</code></p>
<p>所以我们只需要从程序中找到这三个应该满足的条件</p>
<ul>
<li><p><strong><code>[rbp-0x10]</code></strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0x0000555555555689 &lt;+56&gt;:	cmp    DWORD PTR [rbp-0x10],0x7</span><br><span class="line">0x000055555555568d &lt;+60&gt;:	ja     0x555555555790 &lt;phase_3+319&gt;</span><br><span class="line">0x0000555555555790 &lt;+319&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br></pre></td></tr></table></figure>
<p>第一个数字需满足小于等于<code>7</code></p>
</li>
<li><p><strong><code>[rbp-0x11]</code></strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0x000055555555579a &lt;+329&gt;:	cmp    BYTE PTR [rbp-0x11],al</span><br><span class="line">0x000055555555579d &lt;+332&gt;:	jne    0x5555555557b0 &lt;phase_3+351&gt;</span><br><span class="line">0x00005555555557b0 &lt;+351&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br></pre></td></tr></table></figure>
<p>字符的ASCII码需等于前面出现的<code>eax</code></p>
</li>
<li><p><strong><code>[rbp-0xc]</code></strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">0x00005555555556ae &lt;+93&gt;:	mov    eax,0x6a</span><br><span class="line">0x00005555555556b3 &lt;+98&gt;:	cmp    DWORD PTR [rbp-0xc],0x104</span><br><span class="line">0x00005555555556ba &lt;+105&gt;:	je     0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">0x00005555555556c0 &lt;+111&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">0x00005555555556c5 &lt;+116&gt;:	mov    eax,0x6a</span><br><span class="line">0x00005555555556ca &lt;+121&gt;:	jmp    0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line"></span><br><span class="line">0x00005555555556cf &lt;+126&gt;:	mov    eax,0x79</span><br><span class="line">0x00005555555556d4 &lt;+131&gt;:	cmp    DWORD PTR [rbp-0xc],0x59</span><br><span class="line">0x00005555555556d8 &lt;+135&gt;:	je     0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">0x00005555555556de &lt;+141&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">0x00005555555556e3 &lt;+146&gt;:	mov    eax,0x79</span><br><span class="line">0x00005555555556e8 &lt;+151&gt;:	jmp    0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line"></span><br><span class="line">0x00005555555556ed &lt;+156&gt;:	mov    eax,0x7a</span><br><span class="line">0x00005555555556f2 &lt;+161&gt;:	cmp    DWORD PTR [rbp-0xc],0x9a</span><br><span class="line">0x00005555555556f9 &lt;+168&gt;:	je     0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">0x00005555555556ff &lt;+174&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">0x0000555555555704 &lt;+179&gt;:	mov    eax,0x7a</span><br><span class="line">0x0000555555555709 &lt;+184&gt;:	jmp    0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line"></span><br><span class="line">0x000055555555570e &lt;+189&gt;:	mov    eax,0x69</span><br><span class="line">0x0000555555555713 &lt;+194&gt;:	cmp    DWORD PTR [rbp-0xc],0x230</span><br><span class="line">0x000055555555571a &lt;+201&gt;:	je     0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">0x000055555555571c &lt;+203&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">0x0000555555555721 &lt;+208&gt;:	mov    eax,0x69</span><br><span class="line">0x0000555555555726 &lt;+213&gt;:	jmp    0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line"></span><br><span class="line">0x0000555555555728 &lt;+215&gt;:	mov    eax,0x72</span><br><span class="line">0x000055555555572d &lt;+220&gt;:	cmp    DWORD PTR [rbp-0xc],0x398</span><br><span class="line">0x0000555555555734 &lt;+227&gt;:	je     0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">0x0000555555555736 &lt;+229&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">0x000055555555573b &lt;+234&gt;:	mov    eax,0x72</span><br><span class="line">0x0000555555555740 &lt;+239&gt;:	jmp    0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line"></span><br><span class="line">0x0000555555555742 &lt;+241&gt;:	mov    eax,0x71</span><br><span class="line">0x0000555555555747 &lt;+246&gt;:	cmp    DWORD PTR [rbp-0xc],0xe2</span><br><span class="line">0x000055555555574e &lt;+253&gt;:	je     0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">0x0000555555555750 &lt;+255&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">0x0000555555555755 &lt;+260&gt;:	mov    eax,0x71</span><br><span class="line">0x000055555555575a &lt;+265&gt;:	jmp    0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line"></span><br><span class="line">0x000055555555575c &lt;+267&gt;:	mov    eax,0x6f</span><br><span class="line">0x0000555555555761 &lt;+272&gt;:	cmp    DWORD PTR [rbp-0xc],0x207</span><br><span class="line">0x0000555555555768 &lt;+279&gt;:	je     0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">0x000055555555576a &lt;+281&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">0x000055555555576f &lt;+286&gt;:	mov    eax,0x6f</span><br><span class="line">0x0000555555555774 &lt;+291&gt;:	jmp    0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line"></span><br><span class="line">0x0000555555555776 &lt;+293&gt;:	mov    eax,0x77</span><br><span class="line">0x000055555555577b &lt;+298&gt;:	cmp    DWORD PTR [rbp-0xc],0xe1</span><br><span class="line">0x0000555555555782 &lt;+305&gt;:	je     0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line">0x0000555555555784 &lt;+307&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">0x0000555555555789 &lt;+312&gt;:	mov    eax,0x77</span><br><span class="line">0x000055555555578e &lt;+317&gt;:	jmp    0x55555555579a &lt;phase_3+329&gt;</span><br><span class="line"></span><br><span class="line">0x0000555555555790 &lt;+319&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">0x000055555555579a &lt;+329&gt;:	cmp    BYTE PTR [rbp-0x11],al</span><br></pre></td></tr></table></figure>
<p>这里共有8种分支，分别对应着<code>0</code> ~ <code>7</code>，让我们分别输入<code>0</code> ~ <code>7</code>进行调试</p>
<p>设置好断点后，依次输入<code>0</code> <code>1</code> <code>2</code> <code>3</code> <code>4</code> <code>5</code> <code>6</code> <code>7</code>作为第一个数字进行测试</p>
<p>显示反汇编窗口</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) layout asm</span><br></pre></td></tr></table></figure>
<p><img src="/img/jj/bomblab/10.png" alt="img"></p>
<p>通过<code>next</code>命令不断按顺序执行每一行的操作，发现最终跳转到了……</p>
<p><img src="/img/jj/bomblab/11.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0x5555555556ae &lt;phase_3+93&gt;     mov    eax,0x6a</span><br><span class="line">0x5555555556b3 &lt;phase_3+98&gt;     cmp    DWORD PTR [rbp-0xc],0x104</span><br></pre></td></tr></table></figure>
<p>显然，<code>eax</code>对应<code>0x6a</code>，<code>[rbp-0xc]</code>对应<code>0x104</code></p>
<p>而<code>0x6a</code>转换成十进制<code>106</code>，其作为ASCII码对应的字符为<code>j</code></p>
<p><code>0x104</code>对应的数字则为<code>260</code></p>
<p>同理可得其他<code>1</code> ~ <code>7</code>的情况对应的分支</p>
<p>最后<code>Ctrl</code>+<code>X</code>+<code>A</code>退出反编译窗口</p>
<p>故答案有这8种情况：</p>
<blockquote>
<p><code>0 j 260</code></p>
<p><code>1 y 89</code></p>
<p><code>2 z 154</code></p>
<p><code>3 i 560</code></p>
<p><code>4 r 920</code></p>
<p><code>5 q 226</code></p>
<p><code>6 o 519</code></p>
<p><code>7 w 225</code></p>
</blockquote>
</li>
</ul>
<h3 id="·-phase-4"><a href="#·-phase-4" class="headerlink" title="· phase_4"></a><code>· phase_4</code></h3><p>反汇编<code>phase_4</code>函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function phase_4:</span><br><span class="line">   0x00000000000017fa &lt;+0&gt;:	endbr64 </span><br><span class="line">   0x00000000000017fe &lt;+4&gt;:	push   rbp</span><br><span class="line">   0x00000000000017ff &lt;+5&gt;:	mov    rbp,rsp</span><br><span class="line">   0x0000000000001802 &lt;+8&gt;:	sub    rsp,0x10</span><br><span class="line">   0x0000000000001806 &lt;+12&gt;:	mov    rax,QWORD PTR fs:0x28</span><br><span class="line">   0x000000000000180f &lt;+21&gt;:	mov    QWORD PTR [rbp-0x8],rax</span><br><span class="line">   0x0000000000001813 &lt;+25&gt;:	xor    eax,eax</span><br><span class="line">   0x0000000000001815 &lt;+27&gt;:	lea    rcx,[rbp-0xc]</span><br><span class="line">   0x0000000000001819 &lt;+31&gt;:	lea    rdx,[rbp-0x10]</span><br><span class="line">   0x000000000000181d &lt;+35&gt;:	lea    rsi,[rip+0x1b81]        # 0x33a5</span><br><span class="line">   0x0000000000001824 &lt;+42&gt;:	call   0x12c0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">   0x0000000000001829 &lt;+47&gt;:	cmp    eax,0x2</span><br><span class="line">   0x000000000000182c &lt;+50&gt;:	jne    0x1834 &lt;phase_4+58&gt;</span><br><span class="line">   0x000000000000182e &lt;+52&gt;:	cmp    DWORD PTR [rbp-0x10],0xe</span><br><span class="line">   0x0000000000001832 &lt;+56&gt;:	jbe    0x1839 &lt;phase_4+63&gt;</span><br><span class="line">   0x0000000000001834 &lt;+58&gt;:	call   0x1e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x0000000000001839 &lt;+63&gt;:	mov    edx,0xe</span><br><span class="line">   0x000000000000183e &lt;+68&gt;:	mov    esi,0x0</span><br><span class="line">   0x0000000000001843 &lt;+73&gt;:	mov    edi,DWORD PTR [rbp-0x10]</span><br><span class="line">   0x0000000000001846 &lt;+76&gt;:	call   0x17bc &lt;func4&gt;</span><br><span class="line">   0x000000000000184b &lt;+81&gt;:	cmp    eax,0x6</span><br><span class="line">   0x000000000000184e &lt;+84&gt;:	jne    0x1856 &lt;phase_4+92&gt;</span><br><span class="line">   0x0000000000001850 &lt;+86&gt;:	cmp    DWORD PTR [rbp-0xc],0x6</span><br><span class="line">   0x0000000000001854 &lt;+90&gt;:	je     0x185b &lt;phase_4+97&gt;</span><br><span class="line">   0x0000000000001856 &lt;+92&gt;:	call   0x1e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x000000000000185b &lt;+97&gt;:	mov    rax,QWORD PTR [rbp-0x8]</span><br><span class="line">   0x000000000000185f &lt;+101&gt;:	xor    rax,QWORD PTR fs:0x28</span><br><span class="line">   0x0000000000001868 &lt;+110&gt;:	jne    0x186c &lt;phase_4+114&gt;</span><br><span class="line">   0x000000000000186a &lt;+112&gt;:	leave  </span><br><span class="line">   0x000000000000186b &lt;+113&gt;:	ret    </span><br><span class="line">   0x000000000000186c &lt;+114&gt;:	call   0x1220 &lt;__stack_chk_fail@plt&gt;</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<p>反汇编<code>func4</code>函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function func4:</span><br><span class="line">   0x00000000000017bc &lt;+0&gt;:	endbr64 </span><br><span class="line">   0x00000000000017c0 &lt;+4&gt;:	push   rbp</span><br><span class="line">   0x00000000000017c1 &lt;+5&gt;:	mov    rbp,rsp</span><br><span class="line">   0x00000000000017c4 &lt;+8&gt;:	mov    eax,edx</span><br><span class="line">   0x00000000000017c6 &lt;+10&gt;:	sub    eax,esi</span><br><span class="line">   0x00000000000017c8 &lt;+12&gt;:	mov    ecx,eax</span><br><span class="line">   0x00000000000017ca &lt;+14&gt;:	shr    ecx,0x1f</span><br><span class="line">   0x00000000000017cd &lt;+17&gt;:	add    ecx,eax</span><br><span class="line">   0x00000000000017cf &lt;+19&gt;:	sar    ecx,1</span><br><span class="line">   0x00000000000017d1 &lt;+21&gt;:	add    ecx,esi</span><br><span class="line">   0x00000000000017d3 &lt;+23&gt;:	cmp    ecx,edi</span><br><span class="line">   0x00000000000017d5 &lt;+25&gt;:	jg     0x17e0 &lt;func4+36&gt;</span><br><span class="line">   0x00000000000017d7 &lt;+27&gt;:	mov    eax,0x0</span><br><span class="line">   0x00000000000017dc &lt;+32&gt;:	jl     0x17ec &lt;func4+48&gt;</span><br><span class="line">   0x00000000000017de &lt;+34&gt;:	pop    rbp</span><br><span class="line">   0x00000000000017df &lt;+35&gt;:	ret    </span><br><span class="line">   0x00000000000017e0 &lt;+36&gt;:	lea    edx,[rcx-0x1]</span><br><span class="line">   0x00000000000017e3 &lt;+39&gt;:	call   0x17bc &lt;func4&gt;</span><br><span class="line">   0x00000000000017e8 &lt;+44&gt;:	add    eax,eax</span><br><span class="line">   0x00000000000017ea &lt;+46&gt;:	jmp    0x17de &lt;func4+34&gt;</span><br><span class="line">   0x00000000000017ec &lt;+48&gt;:	lea    esi,[rcx+0x1]</span><br><span class="line">   0x00000000000017ef &lt;+51&gt;:	call   0x17bc &lt;func4&gt;</span><br><span class="line">   0x00000000000017f4 &lt;+56&gt;:	lea    eax,[rax+rax*1+0x1]</span><br><span class="line">   0x00000000000017f8 &lt;+60&gt;:	jmp    0x17de &lt;func4+34&gt;</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<p>查看内存地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x0000000000001815 &lt;+27&gt;:	lea    rcx,[rbp-0xc]</span><br><span class="line">0x0000000000001819 &lt;+31&gt;:	lea    rdx,[rbp-0x10]</span><br><span class="line">0x000000000000181d &lt;+35&gt;:	lea    rsi,[rip+0x1b81]        # 0x33a5</span><br><span class="line">0x0000000000001824 &lt;+42&gt;:	call   0x12c0 &lt;__isoc99_sscanf@plt&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x/s 0x33a5</span><br></pre></td></tr></table></figure>
<p><img src="/img/jj/bomblab/12.png" alt="img"></p>
<p>需要输入两个数字，分别存到<code>[rbp-0x10]</code>和<code>[rbp-0xc]</code>里</p>
<p>阅读<code>phase_4</code>程序我们发现</p>
<p>第一个数字必须小于等于<code>14</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0x000000000000182e &lt;+52&gt;:	cmp    DWORD PTR [rbp-0x10],0xe</span><br><span class="line">0x0000000000001832 &lt;+56&gt;:	jbe    0x1839 &lt;phase_4+63&gt;</span><br><span class="line">0x0000000000001834 &lt;+58&gt;:	call   0x1e02 &lt;explode_bomb&gt;</span><br></pre></td></tr></table></figure>
<p><code>func4</code>函数返回值必须为<code>6</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x0000000000001846 &lt;+76&gt;:	call   0x17bc &lt;func4&gt;</span><br><span class="line">0x000000000000184b &lt;+81&gt;:	cmp    eax,0x6</span><br><span class="line">0x000000000000184e &lt;+84&gt;:	jne    0x1856 &lt;phase_4+92&gt;</span><br><span class="line">0x0000000000001856 &lt;+92&gt;:	call   0x1e02 &lt;explode_bomb&gt;</span><br></pre></td></tr></table></figure>
<p>第二个数字必须为<code>6</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0x0000000000001850 &lt;+86&gt;:	cmp    DWORD PTR [rbp-0xc],0x6</span><br><span class="line">0x0000000000001854 &lt;+90&gt;:	je     0x185b &lt;phase_4+97&gt;</span><br><span class="line">0x0000000000001856 &lt;+92&gt;:	call   0x1e02 &lt;explode_bomb&gt;</span><br></pre></td></tr></table></figure>
<p>通过解析<code>func4</code>函数以及需要传入的参数，我们可以推理出，第一个数字也必须为<code>6</code></p>
<p>故答案为：</p>
<blockquote>
<p><code>6 6</code></p>
</blockquote>
<h3 id="·-phase-5"><a href="#·-phase-5" class="headerlink" title="· phase_5"></a><code>· phase_5</code></h3><p>反汇编<code>phase_5</code>函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function phase_5:</span><br><span class="line">   0x0000000000001871 &lt;+0&gt;:	endbr64 </span><br><span class="line">   0x0000000000001875 &lt;+4&gt;:	push   rbp</span><br><span class="line">   0x0000000000001876 &lt;+5&gt;:	mov    rbp,rsp</span><br><span class="line">   0x0000000000001879 &lt;+8&gt;:	push   rbx</span><br><span class="line">   0x000000000000187a &lt;+9&gt;:	sub    rsp,0x18</span><br><span class="line">   0x000000000000187e &lt;+13&gt;:	mov    rbx,rdi</span><br><span class="line">   0x0000000000001881 &lt;+16&gt;:	mov    rax,QWORD PTR fs:0x28</span><br><span class="line">   0x000000000000188a &lt;+25&gt;:	mov    QWORD PTR [rbp-0x18],rax</span><br><span class="line">   0x000000000000188e &lt;+29&gt;:	xor    eax,eax</span><br><span class="line">   0x0000000000001890 &lt;+31&gt;:	call   0x1b65 &lt;string_length&gt;</span><br><span class="line">   0x0000000000001895 &lt;+36&gt;:	cmp    eax,0x6</span><br><span class="line">   0x0000000000001898 &lt;+39&gt;:	jne    0x18ed &lt;phase_5+124&gt;</span><br><span class="line">   0x000000000000189a &lt;+41&gt;:	mov    eax,0x0</span><br><span class="line">   0x000000000000189f &lt;+46&gt;:	lea    rcx,[rip+0x193a]        # 0x31e0 &lt;array.3473&gt;</span><br><span class="line">   0x00000000000018a6 &lt;+53&gt;:	movzx  edx,BYTE PTR [rbx+rax*1]</span><br><span class="line">   0x00000000000018aa &lt;+57&gt;:	and    edx,0xf</span><br><span class="line">   0x00000000000018ad &lt;+60&gt;:	movzx  edx,BYTE PTR [rcx+rdx*1]</span><br><span class="line">   0x00000000000018b1 &lt;+64&gt;:	mov    BYTE PTR [rbp+rax*1-0x1f],dl</span><br><span class="line">   0x00000000000018b5 &lt;+68&gt;:	add    rax,0x1</span><br><span class="line">   0x00000000000018b9 &lt;+72&gt;:	cmp    rax,0x6</span><br><span class="line">   0x00000000000018bd &lt;+76&gt;:	jne    0x18a6 &lt;phase_5+53&gt;</span><br><span class="line">   0x00000000000018bf &lt;+78&gt;:	mov    BYTE PTR [rbp-0x19],0x0</span><br><span class="line">   0x00000000000018c3 &lt;+82&gt;:	lea    rdi,[rbp-0x1f]</span><br><span class="line">   0x00000000000018c7 &lt;+86&gt;:	lea    rsi,[rip+0x18e1]        # 0x31af</span><br><span class="line">   0x00000000000018ce &lt;+93&gt;:	call   0x1b86 &lt;strings_not_equal&gt;</span><br><span class="line">   0x00000000000018d3 &lt;+98&gt;:	test   eax,eax</span><br><span class="line">   0x00000000000018d5 &lt;+100&gt;:	jne    0x18f4 &lt;phase_5+131&gt;</span><br><span class="line">   0x00000000000018d7 &lt;+102&gt;:	mov    rax,QWORD PTR [rbp-0x18]</span><br><span class="line">   0x00000000000018db &lt;+106&gt;:	xor    rax,QWORD PTR fs:0x28</span><br><span class="line">   0x00000000000018e4 &lt;+115&gt;:	jne    0x18fb &lt;phase_5+138&gt;</span><br><span class="line">   0x00000000000018e6 &lt;+117&gt;:	add    rsp,0x18</span><br><span class="line">   0x00000000000018ea &lt;+121&gt;:	pop    rbx</span><br><span class="line">   0x00000000000018eb &lt;+122&gt;:	pop    rbp</span><br><span class="line">   0x00000000000018ec &lt;+123&gt;:	ret    </span><br><span class="line">   0x00000000000018ed &lt;+124&gt;:	call   0x1e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x00000000000018f2 &lt;+129&gt;:	jmp    0x189a &lt;phase_5+41&gt;</span><br><span class="line">   0x00000000000018f4 &lt;+131&gt;:	call   0x1e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x00000000000018f9 &lt;+136&gt;:	jmp    0x18d7 &lt;phase_5+102&gt;</span><br><span class="line">   0x00000000000018fb &lt;+138&gt;:	call   0x1220 &lt;__stack_chk_fail@plt&gt;</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<p>老规矩，查看内存地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x00000000000018c7 &lt;+86&gt;:	lea    rsi,[rip+0x18e1]        # 0x31af</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x/s 0x31af</span><br></pre></td></tr></table></figure>
<p><img src="/img/jj/bomblab/13.png" alt="img"></p>
<p>但是我们发现，这关与第一关不一样，并不是直接复制粘贴就行</p>
<p>当我们查看另一个内存地址时</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x000000000000189f &lt;+46&gt;:	lea    rcx,[rip+0x193a]        # 0x31e0 &lt;array.3473&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/s 0x31e0</span><br><span class="line">0x31e0 &lt;array.3473&gt;:	&quot;maduiersnfotvbylSo you think you can stop the bomb with ctrl-c, do you?&quot;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>So you think you can stop the bomb with ctrl-c, do you?</p>
<p>所以你认为你可以用ctrl-c来阻止炸弹，是吗？</p>
</blockquote>
<p>显然不行</p>
<p>分析程序知，是通过取我们输入六个字符的<code>ASCII</code>码的低四位作为索引值，查找<code>maduiersnfotvbyl</code>里的字符组成</p>
<p><code>maduiersnfotvbyl</code>中<code>f</code>为第<code>9</code>位，<code>l</code>为第<code>15</code>位，<code>y</code>第<code>14</code>位，<code>e</code>第<code>5</code>位，<code>r</code>第<code>6</code>位，<code>s</code>第<code>7</code>位</p>
<p>也就是说，我们需要输入6个字符，使它们<code>ASCII</code>码低四位分别是：<code>1001</code>, <code>1111</code>, <code>1110</code>, <code>0101</code>, <code>0110</code>, <code>0111</code></p>
<p>所以同样有多种答案（每一位的所有可能的答案如下所示）：</p>
<blockquote>
<ol>
<li><code>I Y i y</code>…</li>
<li><code>O o</code>…</li>
<li><code>N n</code>…</li>
<li><code>E U e u</code>…</li>
<li><code>F V f v</code>…</li>
<li><code>G W g w</code>…</li>
</ol>
</blockquote>
<h3 id="·-phase-6"><a href="#·-phase-6" class="headerlink" title="· phase_6"></a>· phase_6</h3><p>反汇编<code>phase_6</code>函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function phase_6:</span><br><span class="line">   0x0000000000001900 &lt;+0&gt;:	endbr64 </span><br><span class="line">   0x0000000000001904 &lt;+4&gt;:	push   rbp</span><br><span class="line">   0x0000000000001905 &lt;+5&gt;:	mov    rbp,rsp</span><br><span class="line">   0x0000000000001908 &lt;+8&gt;:	push   r15</span><br><span class="line">   0x000000000000190a &lt;+10&gt;:	push   r14</span><br><span class="line">   0x000000000000190c &lt;+12&gt;:	push   r13</span><br><span class="line">   0x000000000000190e &lt;+14&gt;:	push   r12</span><br><span class="line">   0x0000000000001910 &lt;+16&gt;:	push   rbx</span><br><span class="line">   0x0000000000001911 &lt;+17&gt;:	sub    rsp,0x68</span><br><span class="line">   0x0000000000001915 &lt;+21&gt;:	mov    rax,QWORD PTR fs:0x28</span><br><span class="line">   0x000000000000191e &lt;+30&gt;:	mov    QWORD PTR [rbp-0x38],rax</span><br><span class="line">   0x0000000000001922 &lt;+34&gt;:	xor    eax,eax</span><br><span class="line">   0x0000000000001924 &lt;+36&gt;:	lea    r14,[rbp-0x90]</span><br><span class="line">   0x000000000000192b &lt;+43&gt;:	mov    rsi,r14</span><br><span class="line">   0x000000000000192e &lt;+46&gt;:	call   0x1e42 &lt;read_six_numbers&gt;</span><br><span class="line">   0x0000000000001933 &lt;+51&gt;:	mov    r15d,0x1</span><br><span class="line">   0x0000000000001939 &lt;+57&gt;:	mov    r13,r14</span><br><span class="line">   0x000000000000193c &lt;+60&gt;:	jmp    0x1968 &lt;phase_6+104&gt;</span><br><span class="line">   0x000000000000193e &lt;+62&gt;:	call   0x1e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x0000000000001943 &lt;+67&gt;:	jmp    0x1976 &lt;phase_6+118&gt;</span><br><span class="line">   0x0000000000001945 &lt;+69&gt;:	add    rbx,0x1</span><br><span class="line">   0x0000000000001949 &lt;+73&gt;:	cmp    ebx,0x5</span><br><span class="line">   0x000000000000194c &lt;+76&gt;:	jg     0x1960 &lt;phase_6+96&gt;</span><br><span class="line">   0x000000000000194e &lt;+78&gt;:	mov    eax,DWORD PTR [r13+rbx*4+0x0]</span><br><span class="line">   0x0000000000001953 &lt;+83&gt;:	cmp    DWORD PTR [r12],eax</span><br><span class="line">   0x0000000000001957 &lt;+87&gt;:	jne    0x1945 &lt;phase_6+69&gt;</span><br><span class="line">   0x0000000000001959 &lt;+89&gt;:	call   0x1e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x000000000000195e &lt;+94&gt;:	jmp    0x1945 &lt;phase_6+69&gt;</span><br><span class="line">   0x0000000000001960 &lt;+96&gt;:	add    r15,0x1</span><br><span class="line">   0x0000000000001964 &lt;+100&gt;:	add    r14,0x4</span><br><span class="line">   0x0000000000001968 &lt;+104&gt;:	mov    r12,r14</span><br><span class="line">   0x000000000000196b &lt;+107&gt;:	mov    eax,DWORD PTR [r14]</span><br><span class="line">   0x000000000000196e &lt;+110&gt;:	sub    eax,0x1</span><br><span class="line">   0x0000000000001971 &lt;+113&gt;:	cmp    eax,0x5</span><br><span class="line">   0x0000000000001974 &lt;+116&gt;:	ja     0x193e &lt;phase_6+62&gt;</span><br><span class="line">   0x0000000000001976 &lt;+118&gt;:	cmp    r15d,0x5</span><br><span class="line">   0x000000000000197a &lt;+122&gt;:	jg     0x1981 &lt;phase_6+129&gt;</span><br><span class="line">   0x000000000000197c &lt;+124&gt;:	mov    rbx,r15</span><br><span class="line">   0x000000000000197f &lt;+127&gt;:	jmp    0x194e &lt;phase_6+78&gt;</span><br><span class="line">   0x0000000000001981 &lt;+129&gt;:	mov    esi,0x0</span><br><span class="line">   0x0000000000001986 &lt;+134&gt;:	mov    ecx,DWORD PTR [rbp+rsi*4-0x90]</span><br><span class="line">   0x000000000000198d &lt;+141&gt;:	mov    eax,0x1</span><br><span class="line">   0x0000000000001992 &lt;+146&gt;:	lea    rdx,[rip+0x3c97]        # 0x5630 &lt;node1&gt;</span><br><span class="line">   0x0000000000001999 &lt;+153&gt;:	cmp    ecx,0x1</span><br><span class="line">   0x000000000000199c &lt;+156&gt;:	jle    0x19a9 &lt;phase_6+169&gt;</span><br><span class="line">   0x000000000000199e &lt;+158&gt;:	mov    rdx,QWORD PTR [rdx+0x8]</span><br><span class="line">   0x00000000000019a2 &lt;+162&gt;:	add    eax,0x1</span><br><span class="line">   0x00000000000019a5 &lt;+165&gt;:	cmp    eax,ecx</span><br><span class="line">   0x00000000000019a7 &lt;+167&gt;:	jne    0x199e &lt;phase_6+158&gt;</span><br><span class="line">   0x00000000000019a9 &lt;+169&gt;:	mov    QWORD PTR [rbp+rsi*8-0x70],rdx</span><br><span class="line">   0x00000000000019ae &lt;+174&gt;:	add    rsi,0x1</span><br><span class="line">   0x00000000000019b2 &lt;+178&gt;:	cmp    rsi,0x6</span><br><span class="line">   0x00000000000019b6 &lt;+182&gt;:	jne    0x1986 &lt;phase_6+134&gt;</span><br><span class="line">   0x00000000000019b8 &lt;+184&gt;:	mov    rbx,QWORD PTR [rbp-0x70]</span><br><span class="line">   0x00000000000019bc &lt;+188&gt;:	mov    rax,QWORD PTR [rbp-0x68]</span><br><span class="line">   0x00000000000019c0 &lt;+192&gt;:	mov    QWORD PTR [rbx+0x8],rax</span><br><span class="line">   0x00000000000019c4 &lt;+196&gt;:	mov    rdx,QWORD PTR [rbp-0x60]</span><br><span class="line">   0x00000000000019c8 &lt;+200&gt;:	mov    QWORD PTR [rax+0x8],rdx</span><br><span class="line">   0x00000000000019cc &lt;+204&gt;:	mov    rax,QWORD PTR [rbp-0x58]</span><br><span class="line">   0x00000000000019d0 &lt;+208&gt;:	mov    QWORD PTR [rdx+0x8],rax</span><br><span class="line">   0x00000000000019d4 &lt;+212&gt;:	mov    rdx,QWORD PTR [rbp-0x50]</span><br><span class="line">   0x00000000000019d8 &lt;+216&gt;:	mov    QWORD PTR [rax+0x8],rdx</span><br><span class="line">   0x00000000000019dc &lt;+220&gt;:	mov    rax,QWORD PTR [rbp-0x48]</span><br><span class="line">   0x00000000000019e0 &lt;+224&gt;:	mov    QWORD PTR [rdx+0x8],rax</span><br><span class="line">   0x00000000000019e4 &lt;+228&gt;:	mov    QWORD PTR [rax+0x8],0x0</span><br><span class="line">   0x00000000000019ec &lt;+236&gt;:	mov    r12d,0x5</span><br><span class="line">   0x00000000000019f2 &lt;+242&gt;:	jmp    0x19fe &lt;phase_6+254&gt;</span><br><span class="line">   0x00000000000019f4 &lt;+244&gt;:	mov    rbx,QWORD PTR [rbx+0x8]</span><br><span class="line">   0x00000000000019f8 &lt;+248&gt;:	sub    r12d,0x1</span><br><span class="line">   0x00000000000019fc &lt;+252&gt;:	je     0x1a0f &lt;phase_6+271&gt;</span><br><span class="line">   0x00000000000019fe &lt;+254&gt;:	mov    rax,QWORD PTR [rbx+0x8]</span><br><span class="line">   0x0000000000001a02 &lt;+258&gt;:	mov    eax,DWORD PTR [rax]</span><br><span class="line">   0x0000000000001a04 &lt;+260&gt;:	cmp    DWORD PTR [rbx],eax</span><br><span class="line">   0x0000000000001a06 &lt;+262&gt;:	jge    0x19f4 &lt;phase_6+244&gt;</span><br><span class="line">   0x0000000000001a08 &lt;+264&gt;:	call   0x1e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x0000000000001a0d &lt;+269&gt;:	jmp    0x19f4 &lt;phase_6+244&gt;</span><br><span class="line">   0x0000000000001a0f &lt;+271&gt;:	mov    rax,QWORD PTR [rbp-0x38]</span><br><span class="line">   0x0000000000001a13 &lt;+275&gt;:	xor    rax,QWORD PTR fs:0x28</span><br><span class="line">   0x0000000000001a1c &lt;+284&gt;:	jne    0x1a2d &lt;phase_6+301&gt;</span><br><span class="line">   0x0000000000001a1e &lt;+286&gt;:	add    rsp,0x68</span><br><span class="line">   0x0000000000001a22 &lt;+290&gt;:	pop    rbx</span><br><span class="line">   0x0000000000001a23 &lt;+291&gt;:	pop    r12</span><br><span class="line">   0x0000000000001a25 &lt;+293&gt;:	pop    r13</span><br><span class="line">   0x0000000000001a27 &lt;+295&gt;:	pop    r14</span><br><span class="line">   0x0000000000001a29 &lt;+297&gt;:	pop    r15</span><br><span class="line">   0x0000000000001a2b &lt;+299&gt;:	pop    rbp</span><br><span class="line">   0x0000000000001a2c &lt;+300&gt;:	ret    </span><br><span class="line">   0x0000000000001a2d &lt;+301&gt;:	call   0x1220 &lt;__stack_chk_fail@plt&gt;</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<p>题目要求输入6个数字：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x000000000000192e &lt;+46&gt;:	call   0x1e42 &lt;read_six_numbers&gt;</span><br></pre></td></tr></table></figure>
<p>输入的数小于等于6且两两不能相等：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">0x0000000000001945 &lt;+69&gt;:	add    rbx,0x1</span><br><span class="line">0x0000000000001949 &lt;+73&gt;:	cmp    ebx,0x5</span><br><span class="line">0x000000000000194c &lt;+76&gt;:	jg     0x1960 &lt;phase_6+96&gt;</span><br><span class="line">0x000000000000194e &lt;+78&gt;:	mov    eax,DWORD PTR [r13+rbx*4+0x0]</span><br><span class="line">0x0000000000001953 &lt;+83&gt;:	cmp    DWORD PTR [r12],eax</span><br><span class="line">0x0000000000001957 &lt;+87&gt;:	jne    0x1945 &lt;phase_6+69&gt;</span><br><span class="line">0x0000000000001959 &lt;+89&gt;:	call   0x1e02 &lt;explode_bomb&gt;</span><br></pre></td></tr></table></figure>
<p>同时通过地址我们发现了链表，其含6个节点：</p>
<p><img src="/img/jj/bomblab/14.png" alt="img"></p>
<p>分析程序的最后部分发现，根据链表顺序最终的数字应是从大到小排列</p>
<blockquote>
<p><code>2 5 4 1 6 3</code></p>
</blockquote>
<h3 id="·-secret-phase"><a href="#·-secret-phase" class="headerlink" title="· secret_phase"></a><code>· secret_phase</code></h3><p>反汇编<code>phase_defused</code>函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function phase_defused:</span><br><span class="line">   0x0000000000001fc9 &lt;+0&gt;:	endbr64 </span><br><span class="line">   0x0000000000001fcd &lt;+4&gt;:	push   rbp</span><br><span class="line">   0x0000000000001fce &lt;+5&gt;:	mov    rbp,rsp</span><br><span class="line">   0x0000000000001fd1 &lt;+8&gt;:	sub    rsp,0x70</span><br><span class="line">   0x0000000000001fd5 &lt;+12&gt;:	mov    rax,QWORD PTR fs:0x28</span><br><span class="line">   0x0000000000001fde &lt;+21&gt;:	mov    QWORD PTR [rbp-0x8],rax</span><br><span class="line">   0x0000000000001fe2 &lt;+25&gt;:	xor    eax,eax</span><br><span class="line">   0x0000000000001fe4 &lt;+27&gt;:	mov    edi,0x1</span><br><span class="line">   0x0000000000001fe9 &lt;+32&gt;:	call   0x1d1b &lt;send_msg&gt;</span><br><span class="line">   0x0000000000001fee &lt;+37&gt;:	cmp    DWORD PTR [rip+0x3ab7],0x6        # 0x5aac &lt;num_input_strings&gt;</span><br><span class="line">   0x0000000000001ff5 &lt;+44&gt;:	je     0x2008 &lt;phase_defused+63&gt;</span><br><span class="line">   0x0000000000001ff7 &lt;+46&gt;:	mov    rax,QWORD PTR [rbp-0x8]</span><br><span class="line">   0x0000000000001ffb &lt;+50&gt;:	xor    rax,QWORD PTR fs:0x28</span><br><span class="line">   0x0000000000002004 &lt;+59&gt;:	jne    0x2083 &lt;phase_defused+186&gt;</span><br><span class="line">   0x0000000000002006 &lt;+61&gt;:	leave  </span><br><span class="line">   0x0000000000002007 &lt;+62&gt;:	ret    </span><br><span class="line">   0x0000000000002008 &lt;+63&gt;:	lea    rcx,[rbp-0x64]</span><br><span class="line">   0x000000000000200c &lt;+67&gt;:	lea    rdx,[rbp-0x68]</span><br><span class="line">   0x0000000000002010 &lt;+71&gt;:	lea    r8,[rbp-0x60]</span><br><span class="line">   0x0000000000002014 &lt;+75&gt;:	lea    rsi,[rip+0x13d4]        # 0x33ef</span><br><span class="line">   0x000000000000201b &lt;+82&gt;:	lea    rdi,[rip+0x3b8e]        # 0x5bb0 &lt;input_strings+240&gt;</span><br><span class="line">   0x0000000000002022 &lt;+89&gt;:	mov    eax,0x0</span><br><span class="line">   0x0000000000002027 &lt;+94&gt;:	call   0x12c0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">   0x000000000000202c &lt;+99&gt;:	cmp    eax,0x3</span><br><span class="line">   0x000000000000202f &lt;+102&gt;:	je     0x204b &lt;phase_defused+130&gt;</span><br><span class="line">   0x0000000000002031 &lt;+104&gt;:	lea    rdi,[rip+0x1278]        # 0x32b0</span><br><span class="line">   0x0000000000002038 &lt;+111&gt;:	call   0x1200 &lt;puts@plt&gt;</span><br><span class="line">   0x000000000000203d &lt;+116&gt;:	lea    rdi,[rip+0x129c]        # 0x32e0</span><br><span class="line">   0x0000000000002044 &lt;+123&gt;:	call   0x1200 &lt;puts@plt&gt;</span><br><span class="line">   0x0000000000002049 &lt;+128&gt;:	jmp    0x1ff7 &lt;phase_defused+46&gt;</span><br><span class="line">   0x000000000000204b &lt;+130&gt;:	lea    rdi,[rbp-0x60]</span><br><span class="line">   0x000000000000204f &lt;+134&gt;:	lea    rsi,[rip+0x13a2]        # 0x33f8</span><br><span class="line">   0x0000000000002056 &lt;+141&gt;:	call   0x1b86 &lt;strings_not_equal&gt;</span><br><span class="line">   0x000000000000205b &lt;+146&gt;:	test   eax,eax</span><br><span class="line">   0x000000000000205d &lt;+148&gt;:	jne    0x2031 &lt;phase_defused+104&gt;</span><br><span class="line">   0x000000000000205f &lt;+150&gt;:	lea    rdi,[rip+0x11ea]        # 0x3250</span><br><span class="line">   0x0000000000002066 &lt;+157&gt;:	call   0x1200 &lt;puts@plt&gt;</span><br><span class="line">   0x000000000000206b &lt;+162&gt;:	lea    rdi,[rip+0x1206]        # 0x3278</span><br><span class="line">   0x0000000000002072 &lt;+169&gt;:	call   0x1200 &lt;puts@plt&gt;</span><br><span class="line">   0x0000000000002077 &lt;+174&gt;:	mov    eax,0x0</span><br><span class="line">   0x000000000000207c &lt;+179&gt;:	call   0x1a70 &lt;secret_phase&gt;</span><br><span class="line">   0x0000000000002081 &lt;+184&gt;:	jmp    0x2031 &lt;phase_defused+104&gt;</span><br><span class="line">   0x0000000000002083 &lt;+186&gt;:	call   0x1220 &lt;__stack_chk_fail@plt&gt;</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<p>查看这里的几个内存地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x000000000000205f &lt;+150&gt;:	lea    rdi,[rip+0x11ea]        # 0x3250</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/s 0x3250</span><br><span class="line">0x3250:	<span class="string">&quot;Curses, you&#x27;ve found the secret phase!&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x000000000000204f &lt;+134&gt;:	lea    rsi,[rip+0x13a2]        # 0x33f8</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/s 0x33f8</span><br><span class="line">0x33f8:	<span class="string">&quot;DrEvil&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x0000000000002014 &lt;+75&gt;:	lea    rsi,[rip+0x13d4]        # 0x33ef</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/s 0x33ef</span><br><span class="line">0x33ef:	<span class="string">&quot;%d %d %s&quot;</span></span><br></pre></td></tr></table></figure>
<p>显然有个地方是需要我们输入两个数字加一个字符串的，能输入两个数字的就是第四关，我们在其答案的后面添加上<code>DrEvil</code>，成功进入隐藏关卡</p>
<p><img src="/img/jj/bomblab/15.png" alt="img"></p>
<p>反汇编<code>secret_phase</code>函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function secret_phase:</span><br><span class="line">   0x0000555555555a70 &lt;+0&gt;:	endbr64 </span><br><span class="line">   0x0000555555555a74 &lt;+4&gt;:	push   rbp</span><br><span class="line">   0x0000555555555a75 &lt;+5&gt;:	mov    rbp,rsp</span><br><span class="line">   0x0000555555555a78 &lt;+8&gt;:	push   rbx</span><br><span class="line">   0x0000555555555a79 &lt;+9&gt;:	sub    rsp,0x8</span><br><span class="line">   0x0000555555555a7d &lt;+13&gt;:	call   0x555555555e84 &lt;read_line&gt;</span><br><span class="line">   0x0000555555555a82 &lt;+18&gt;:	mov    rdi,rax</span><br><span class="line">   0x0000555555555a85 &lt;+21&gt;:	mov    edx,0xa</span><br><span class="line">   0x0000555555555a8a &lt;+26&gt;:	mov    esi,0x0</span><br><span class="line">   0x0000555555555a8f &lt;+31&gt;:	call   0x5555555552a0 &lt;strtol@plt&gt;</span><br><span class="line">   0x0000555555555a94 &lt;+36&gt;:	mov    rbx,rax</span><br><span class="line">   0x0000555555555a97 &lt;+39&gt;:	lea    eax,[rax-0x1]</span><br><span class="line">   0x0000555555555a9a &lt;+42&gt;:	cmp    eax,0x3e8</span><br><span class="line">   0x0000555555555a9f &lt;+47&gt;:	ja     0x555555555acc &lt;secret_phase+92&gt;</span><br><span class="line">   0x0000555555555aa1 &lt;+49&gt;:	mov    esi,ebx</span><br><span class="line">   0x0000555555555aa3 &lt;+51&gt;:	lea    rdi,[rip+0x3aa6]        # 0x555555559550 &lt;n1&gt;</span><br><span class="line">   0x0000555555555aaa &lt;+58&gt;:	call   0x555555555a32 &lt;fun7&gt;</span><br><span class="line">   0x0000555555555aaf &lt;+63&gt;:	cmp    eax,0x2</span><br><span class="line">   0x0000555555555ab2 &lt;+66&gt;:	jne    0x555555555ad3 &lt;secret_phase+99&gt;</span><br><span class="line">   0x0000555555555ab4 &lt;+68&gt;:	lea    rdi,[rip+0x16c5]        # 0x555555557180</span><br><span class="line">   0x0000555555555abb &lt;+75&gt;:	call   0x555555555200 &lt;puts@plt&gt;</span><br><span class="line">   0x0000555555555ac0 &lt;+80&gt;:	call   0x555555555fc9 &lt;phase_defused&gt;</span><br><span class="line">   0x0000555555555ac5 &lt;+85&gt;:	add    rsp,0x8</span><br><span class="line">   0x0000555555555ac9 &lt;+89&gt;:	pop    rbx</span><br><span class="line">   0x0000555555555aca &lt;+90&gt;:	pop    rbp</span><br><span class="line">   0x0000555555555acb &lt;+91&gt;:	ret    </span><br><span class="line">   0x0000555555555acc &lt;+92&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x0000555555555ad1 &lt;+97&gt;:	jmp    0x555555555aa1 &lt;secret_phase+49&gt;</span><br><span class="line">   0x0000555555555ad3 &lt;+99&gt;:	call   0x555555555e02 &lt;explode_bomb&gt;</span><br><span class="line">   0x0000555555555ad8 &lt;+104&gt;:	jmp    0x555555555ab4 &lt;secret_phase+68&gt;</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<p>反汇编<code>fun7</code>函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function fun7:</span><br><span class="line">   0x0000555555555a32 &lt;+0&gt;:	endbr64 </span><br><span class="line">   0x0000555555555a36 &lt;+4&gt;:	test   rdi,rdi</span><br><span class="line">   0x0000555555555a39 &lt;+7&gt;:	je     0x555555555a6a &lt;fun7+56&gt;</span><br><span class="line">   0x0000555555555a3b &lt;+9&gt;:	push   rbp</span><br><span class="line">   0x0000555555555a3c &lt;+10&gt;:	mov    rbp,rsp</span><br><span class="line">   0x0000555555555a3f &lt;+13&gt;:	mov    edx,DWORD PTR [rdi]</span><br><span class="line">   0x0000555555555a41 &lt;+15&gt;:	cmp    edx,esi</span><br><span class="line">   0x0000555555555a43 &lt;+17&gt;:	jg     0x555555555a4e &lt;fun7+28&gt;</span><br><span class="line">   0x0000555555555a45 &lt;+19&gt;:	mov    eax,0x0</span><br><span class="line">   0x0000555555555a4a &lt;+24&gt;:	jne    0x555555555a5b &lt;fun7+41&gt;</span><br><span class="line">   0x0000555555555a4c &lt;+26&gt;:	pop    rbp</span><br><span class="line">   0x0000555555555a4d &lt;+27&gt;:	ret    </span><br><span class="line">   0x0000555555555a4e &lt;+28&gt;:	mov    rdi,QWORD PTR [rdi+0x8]</span><br><span class="line">   0x0000555555555a52 &lt;+32&gt;:	call   0x555555555a32 &lt;fun7&gt;</span><br><span class="line">   0x0000555555555a57 &lt;+37&gt;:	add    eax,eax</span><br><span class="line">   0x0000555555555a59 &lt;+39&gt;:	jmp    0x555555555a4c &lt;fun7+26&gt;</span><br><span class="line">   0x0000555555555a5b &lt;+41&gt;:	mov    rdi,QWORD PTR [rdi+0x10]</span><br><span class="line">   0x0000555555555a5f &lt;+45&gt;:	call   0x555555555a32 &lt;fun7&gt;</span><br><span class="line">   0x0000555555555a64 &lt;+50&gt;:	lea    eax,[rax+rax*1+0x1]</span><br><span class="line">   0x0000555555555a68 &lt;+54&gt;:	jmp    0x555555555a4c &lt;fun7+26&gt;</span><br><span class="line">   0x0000555555555a6a &lt;+56&gt;:	mov    eax,0xffffffff</span><br><span class="line">   0x0000555555555a6f &lt;+61&gt;:	ret    </span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<p>先分析<code>secret_phase</code>函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x0000555555555aa1 &lt;+49&gt;:	mov    esi,ebx</span><br><span class="line">0x0000555555555aa3 &lt;+51&gt;:	lea    rdi,[rip+0x3aa6]        # 0x555555559550 &lt;n1&gt;</span><br><span class="line">0x0000555555555aaa &lt;+58&gt;:	call   0x555555555a32 &lt;fun7&gt;</span><br><span class="line">0x0000555555555aaf &lt;+63&gt;:	cmp    eax,0x2</span><br></pre></td></tr></table></figure>
<p>这里向<code>fun7</code>传了两个参数，并要求返回值为2，其中一个参数<code>esi</code>存的是我们输入的数，另一个是内存地址：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/56x 0x555555559550</span><br><span class="line">0x555555559550 &lt;n1&gt;:		0x00000024  0x00000000  0x00005570  0x00000000</span><br><span class="line">0x555555559560 &lt;n1+16&gt;:		0x00005590  0x00000000  0x00000000  0x00000000</span><br><span class="line">0x555555559570 &lt;n21&gt;:		0x00000008  0x00000000  0x000055f0  0x00000000</span><br><span class="line">0x555555559580 &lt;n21+16&gt;:	0x000055b0  0x00000000  0x00000000  0x00000000</span><br><span class="line">0x555555559590 &lt;n22&gt;:		0x00000032  0x00000000  0x000055d0  0x00000000</span><br><span class="line">0x5555555595a0 &lt;n22+16&gt;:	0x00005610  0x00000000  0x00000000  0x00000000</span><br><span class="line">0x5555555595b0 &lt;n32&gt;:		0x00000016  0x00000000  0x000050c0  0x00000000</span><br><span class="line">0x5555555595c0 &lt;n32+16&gt;:	0x00005080  0x00000000  0x00000000  0x00000000</span><br><span class="line">0x5555555595d0 &lt;n33&gt;:		0x0000002d  0x00000000  0x00005020  0x00000000</span><br><span class="line">0x5555555595e0 &lt;n33+16&gt;:	0x000050e0  0x00000000  0x00000000  0x00000000</span><br><span class="line">0x5555555595f0 &lt;n31&gt;:		0x00000006  0x00000000  0x00005040  0x00000000</span><br><span class="line">0x555555559600 &lt;n31+16&gt;:	0x000050a0  0x00000000  0x00000000  0x00000000</span><br><span class="line">0x555555559610 &lt;n34&gt;:		0x0000006b  0x00000000  0x00005060  0x00000000</span><br><span class="line">0x555555559620 &lt;n34+16&gt;:	0x00005100  0x00000000  0x00000000  0x00000000</span><br></pre></td></tr></table></figure>
<p>这类似于树的结构，根据节点关系，可以画出如下图所示的树：</p>
<p><img src="https://pic3.zhimg.com/80/v2-9b3ac7a82463fe7a226d5ecb716386f2_720w.webp" alt="img"></p>
<p>根据对<code>fun7</code>函数的分析，想要返回2，推理出<code>22</code>是正确的结果</p>
<blockquote>
<p>22</p>
</blockquote>
<h2 id="四、实验结果："><a href="#四、实验结果：" class="headerlink" title="四、实验结果："></a>四、实验结果：</h2><ul>
<li><p>phase_1</p>
<p><img src="/img/jj/bomblab/16.png" alt="img"></p>
</li>
<li><p>phase_2</p>
<p><img src="/img/jj/bomblab/17.png" alt="img"></p>
</li>
<li><p>phase_3</p>
<p><img src="/img/jj/bomblab/18.png" alt="img"></p>
</li>
<li><p>phase_4</p>
<p><img src="/img/jj/bomblab/19.png" alt="img"></p>
</li>
<li><p>phase_5</p>
<p><img src="/img/jj/bomblab/20.png" alt="img"></p>
</li>
<li><p>phase_6</p>
<p><img src="/img/jj/bomblab/21.png" alt="img"></p>
</li>
<li><p>secret_phase</p>
<p><img src="/img/jj/bomblab/22.png" alt="img"></p>
<p><img src="/img/jj/bomblab/23.png" alt="img"></p>
</li>
</ul>
<h2 id="五、实验总结："><a href="#五、实验总结：" class="headerlink" title="五、实验总结："></a>五、实验总结：</h2><blockquote>
<ul>
<li>实验过程中，我经历了七个不同阶段的挑战，每个阶段都考察了机器级语言程序的不同方面，随着阶段的递增，难度也逐渐提升。在这个过程中，我深刻体会到了计算机科学中的一些重要概念，并从中获得了丰富的经验和收获。</li>
<li>在第一阶段的字符串比较中，我对字符串的处理有了更深入的了解，学会了如何有效地进行字符串比较操作。这为后续的阶段奠定了基础，也提升了我的编程技能。</li>
<li>第二阶段涉及循环结构，我学到了如何使用循环语句来处理复杂的任务，同时也加深了对程序执行流程的理解。这对于编写高效且可维护的代码至关重要。</li>
<li>在第三阶段，我面对条件和分支结构，包括switch语句的运用。这使我更加熟悉如何根据不同的情况执行不同的代码段，提高了我的程序设计灵活性。</li>
<li>第四阶段涉及递归调用和栈的使用，这是一个相对较复杂的部分。通过解决这一阶段的问题，我深入了解了递归的原理和栈的运作机制，为处理更加复杂的程序问题打下了基础。</li>
<li>指针是编程中一个重要而复杂的概念，在第五阶段，我深入研究了指针的应用。这帮助我更好地理解内存管理和数据结构，为高效的内存操作提供了技能支持。</li>
<li>第六阶段涉及链表、指针和结构的操作，这对于处理更加复杂的数据结构和算法问题至关重要。我通过这一阶段的实践，掌握了处理复杂数据结构的技能。</li>
<li>在实验的隐藏阶段，我面对了一些挑战，特别是在处理阶段四之后附加特定字符串的情况。这要求我灵活运用之前学到的知识，解决问题的能力得到了锻炼。</li>
<li>总的来说，通过这个实验，我不仅加深了对机器级语言程序设计的理解，还提高了解决复杂问题的能力。在未来的学习和工作中，我将继续运用这些经验和技能，不断提升自己在计算机科学领域的水平。这次实验是一次深刻的学习过程，为我未来的编程生涯打下了坚实的基础。</li>
</ul>
</blockquote>
</article><div class="icat-license"><div class="icat-license-img"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30"><g><path d="M14.972 0c4.196 0 7.769 1.465 10.715 4.393A14.426 14.426 0 0128.9 9.228C29.633 11.04 30 12.964 30 15c0 2.054-.363 3.978-1.085 5.772a13.77 13.77 0 01-3.2 4.754 15.417 15.417 0 01-4.983 3.322A14.932 14.932 0 0114.973 30c-1.982 0-3.88-.38-5.692-1.14a15.087 15.087 0 01-4.875-3.293c-1.437-1.437-2.531-3.058-3.281-4.862A14.71 14.71 0 010 15c0-1.982.38-3.888 1.138-5.719a15.062 15.062 0 013.308-4.915C7.303 1.456 10.812 0 14.972 0zm.055 2.706c-3.429 0-6.313 1.196-8.652 3.589a12.896 12.896 0 00-2.72 4.031 11.814 11.814 0 00-.95 4.675c0 1.607.316 3.156.95 4.646a12.428 12.428 0 002.72 3.992 12.362 12.362 0 003.99 2.679c1.483.616 3.037.924 4.662.924 1.607 0 3.164-.312 4.675-.937a12.954 12.954 0 004.084-2.705c2.339-2.286 3.508-5.152 3.508-8.6 0-1.66-.304-3.231-.91-4.713a11.994 11.994 0 00-2.651-3.965c-2.412-2.41-5.314-3.616-8.706-3.616zm-.188 9.803l-2.01 1.045c-.215-.445-.477-.758-.79-.937-.312-.178-.602-.268-.87-.268-1.34 0-2.01.884-2.01 2.652 0 .803.17 1.446.509 1.928.34.482.84.724 1.5.724.876 0 1.492-.43 1.85-1.286l1.847.937a4.407 4.407 0 01-1.634 1.728c-.696.42-1.464.63-2.303.63-1.34 0-2.42-.41-3.242-1.233-.821-.82-1.232-1.964-1.232-3.428 0-1.428.416-2.562 1.246-3.401.83-.84 1.879-1.26 3.147-1.26 1.858 0 3.188.723 3.992 2.17zm8.652 0l-1.983 1.045c-.214-.445-.478-.758-.79-.937-.313-.178-.613-.268-.897-.268-1.34 0-2.01.884-2.01 2.652 0 .803.17 1.446.51 1.928.338.482.838.724 1.5.724.874 0 1.49-.43 1.847-1.286l1.875.937a4.606 4.606 0 01-1.66 1.728c-.696.42-1.455.63-2.277.63-1.357 0-2.441-.41-3.253-1.233-.814-.82-1.22-1.964-1.22-3.428 0-1.428.415-2.562 1.246-3.401.83-.84 1.879-1.26 3.147-1.26 1.857 0 3.18.723 3.965 2.17z"></path></g></svg></div><div class="icat-license-title">计算机系统基础-Bomb Lab 实验报告</div><div class="icat-license-link"><a href="https://yogurt114514.github.io/posts/bomblab.html">https://yogurt114514.github.io/posts/bomblab.html</a></div><div class="icat-license-meta"><div class="icat-license-meta-item"><div class="icat-license-meta-title">本文作者</div><div class="icat-license-meta-text">火<a></a></div></div><div class="icat-license-meta-item"><div class="icat-license-meta-title">最后更新</div><div class="icat-license-meta-text">2024-10-24</div></div><div class="icat-license-meta-item"><div class="icat-license-meta-title">许可协议</div><div class="icat-license-meta-text"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans" rel="nofollow noopener noreferrer" target="_blank">CC BY-NC-SA 4.0</a></div></div></div><div class="icat-license-tips">此文章版权归 火 所有。如需转载，请注明来自原作者！</div></div><div class="tag_share"><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>打赏</div><div class="reward-main"><ul class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></ul></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E4%BD%9C%E4%B8%9A/">作业</a><a class="post-meta__tags" href="/tags/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/">实验报告</a><a class="post-meta__tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/">计算机系统基础</a><a class="post-meta__tags" href="/tags/%E8%AE%A1%E5%9F%BA/">计基</a><a class="post-meta__tags" href="/tags/%E6%8B%86%E5%BC%B9/">拆弹</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.png" data-sites="qq,wechat"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a href="/posts/attacklab.html" title="计算机系统基础-Attack Lab 实验报告"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-23</div><div class="title">计算机系统基础-Attack Lab 实验报告</div></div></a><a href="/posts/discrete_1.html" title="离散数学II实验一（Python&#x2F;C++）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-22</div><div class="title">离散数学II实验一（Python&#x2F;C++）</div></div></a><a href="/posts/discrete_3.html" title="离散数学II实验三（Python&#x2F;C++）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-23</div><div class="title">离散数学II实验三（Python&#x2F;C++）</div></div></a><a href="/posts/discrete_2.html" title="离散数学II实验二（Python&#x2F;C++）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-22</div><div class="title">离散数学II实验二（Python&#x2F;C++）</div></div></a><a href="/posts/pigai.html" title="批改网英语作文无法“粘贴”的解决办法"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-01</div><div class="title">批改网英语作文无法“粘贴”的解决办法</div></div></a><a href="/posts/game_Journey-to-the-West.html" title="自制游戏（小组合作-作业）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-02</div><div class="title">自制游戏（小组合作-作业）</div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info is-center"><div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">火</div><div class="author-info-description">人生若只如初见</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">53</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Yogurt114514"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;amp;uin=1157733847&amp;amp;site=qq&amp;amp;menu=yes" target="_blank" title="QQ"><i class="fa-brands fa-qq" style="color: #68A5E1;"></i></a><a class="social-icon" href="mailto:1157733847@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #30CA9B;"></i></a><a class="social-icon" href="https://space.bilibili.com/527589079" target="_blank" title="Bilibili"><i class="fa-brands fa-bilibili" style="color: #fb7299;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">孩子们我回来了。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E4%B8%8E%E6%8A%80%E6%9C%AF%E7%B3%BB"><span class="toc-number">1.</span> <span class="toc-text">中国海洋大学 计算机科学与技术系</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A"><span class="toc-number">1.1.</span> <span class="toc-text">实验报告</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84%EF%BC%9A"><span class="toc-number">1.2.</span> <span class="toc-text">一、实验目的：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A"><span class="toc-number">1.3.</span> <span class="toc-text">二、实验要求：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9%EF%BC%9A"><span class="toc-number">1.4.</span> <span class="toc-text">三、实验内容：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%C2%B7-%E6%8B%86%E5%BC%B9%E5%89%8D%E5%87%86%E5%A4%87"><span class="toc-number">1.4.1.</span> <span class="toc-text">· 拆弹前准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%C2%B7-%E5%90%AF%E5%8A%A8GDB"><span class="toc-number">1.4.2.</span> <span class="toc-text">· 启动GDB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%C2%B7-phase-1"><span class="toc-number">1.4.3.</span> <span class="toc-text">· phase_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%C2%B7-phase-2"><span class="toc-number">1.4.4.</span> <span class="toc-text">· phase_2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%C2%B7-phase-3"><span class="toc-number">1.4.5.</span> <span class="toc-text">· phase_3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%C2%B7-phase-4"><span class="toc-number">1.4.6.</span> <span class="toc-text">· phase_4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%C2%B7-phase-5"><span class="toc-number">1.4.7.</span> <span class="toc-text">· phase_5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%C2%B7-phase-6"><span class="toc-number">1.4.8.</span> <span class="toc-text">· phase_6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%C2%B7-secret-phase"><span class="toc-number">1.4.9.</span> <span class="toc-text">· secret_phase</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C%EF%BC%9A"><span class="toc-number">1.5.</span> <span class="toc-text">四、实验结果：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%AE%9E%E9%AA%8C%E6%80%BB%E7%BB%93%EF%BC%9A"><span class="toc-number">1.6.</span> <span class="toc-text">五、实验总结：</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最近更新</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/conan_op_ed.html" title="名侦探柯南OP/ED全集统计">名侦探柯南OP/ED全集统计</a><time datetime="2024-01-25T13:09:10.000Z" title="发表于 2024-01-25 21:09:10">2024-01-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/attacklab.html" title="计算机系统基础-Attack Lab 实验报告">计算机系统基础-Attack Lab 实验报告</a><time datetime="2024-01-23T13:09:11.000Z" title="发表于 2024-01-23 21:09:11">2024-01-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/discrete_3.html" title="离散数学II实验三（Python/C++）">离散数学II实验三（Python/C++）</a><time datetime="2024-01-23T13:09:10.000Z" title="发表于 2024-01-23 21:09:10">2024-01-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/2023.html" title="2023-年终总结">2023-年终总结</a><time datetime="2023-12-31T13:09:10.000Z" title="发表于 2023-12-31 21:09:10">2023-12-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/discrete_2.html" title="离散数学II实验二（Python/C++）">离散数学II实验二（Python/C++）</a><time datetime="2023-12-22T13:09:12.000Z" title="发表于 2023-12-22 21:09:12">2023-12-22</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;Sat Apr 22 2023 05:20:00 GMT+0800 (中国标准时间) - 2024 By 火</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">将生活带给你的如柠檬的酸楚，酿成犹如柠檬汽水味般的甘甜。</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"></div><div id="rightside-config-show"><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://fourfire.netlify.app/.netlify/functions/twikoo',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://fourfire.netlify.app/.netlify/functions/twikoo',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))

    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(init,0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(init)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="dist/js/social-share.min.js"></script><script src="/js/music.js"></script><script src="/js/about.js"></script><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script src="https://sdk.51.la/perf/js-sdk-perf.min.js" crossorigin="anonymous"></script><script>LA.init({id:"3Gb2d1ilYEbfGv4u",ck:"3Gb2d1ilYEbfGv4u"})</script><script>new LingQue.Monitor().init({id:"3GdyhP4pw3iZPXIo",sendSuspicious:true});</script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script id="canvas_nest" defer="defer" color="255,190,0" opacity="0.7" zIndex="-1" count="50" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      pjax.loadUrl('/404.html')
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start --><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>